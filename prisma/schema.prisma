datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Week {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  isFinal   Boolean  @default(false)

  label     String
  eventName String
  eventYear Int
  eventId   String   @unique

  bets      Bet[]

  @@index([createdAt])
}

model Bet {
  id                 Int      @id @default(autoincrement())
  weekId             Int
  week               Week     @relation(fields: [weekId], references: [id], onDelete: Cascade)

  placedAtUtc        String?
  betType            String
  playerName         String
  dgId               Int?
  marketBookBest     String?
  marketOddsBestDec  Float?
  stakeUnits         Float?

  pModel             Float?
  edgeProb           Float?
  evPerUnit          Float?
  kellyFull          Float?
  kellyFrac          Float?

  resultWinFlag      Int?
  returnUnits        Float?

  @@index([weekId])
}

enum BetslipStatus {
  PENDING
  PLACED
}

model BetslipItem {
  id                 String        @id @default(cuid())
  uniqueKey          String        @unique
  eventId            String
  eventName          String
  eventYear          Int
  market             String
  playerName         String
  dgId               String?
  opponents          String?
  marketBookBest     String?
  marketOddsBestDec  Float?
  oddsEnteredDec     Float?
  pModel             Float?
  edgeProb           Float?
  evPerUnit          Float?
  kellyFull          Float?
  kellyFrac          Float?
  stakeUnits         Float?
  status             BetslipStatus @default(PENDING)
  archivedAt         DateTime?
  createdAt          DateTime      @default(now())
  updatedAt          DateTime      @updatedAt
}
